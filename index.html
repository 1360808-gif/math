<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ã‚ã¾ã‚Šã®ã‚ã‚‹ ã‚ã‚Šç®—ï¼ˆ3å¹´ç”Ÿï¼‰</title>

<style>
:root{
  --bg:#f7f8ff;
  --card:#ffffff;
  --ink:#1f2937;
  --muted:#6b7280;
  --line:#e5e7eb;
  --good:#16a34a;
  --bad:#dc2626;
  --accent:#4f46e5;
  --shadow:0 10px 24px rgba(0,0,0,.08);
  --radius:18px;
}
*{ box-sizing:border-box; }

body{
  margin:0;
  font-family:system-ui,-apple-system,"Hiragino Sans","Noto Sans JP",sans-serif;
  background:var(--bg);
  color:var(--ink);
}
.wrap{ max-width:980px; margin:16px auto; padding:0 12px 40px; }

.top{
  background:#fff;
  border:1px solid var(--line);
  border-radius:24px;
  padding:14px;
  box-shadow:var(--shadow);
}
h1{ margin:0 0 6px; font-size:22px; }

.controls button{
  margin:4px 4px 0 0;
  padding:8px 12px;
  border-radius:12px;
  border:none;
  font-weight:900;
  background:var(--accent);
  color:#fff;
  cursor:pointer;
}
.controls .secondary{
  background:#fff;
  color:var(--ink);
  border:1px solid var(--line);
}

.mascot{
  display:flex;
  align-items:center;
  gap:10px;
  margin-top:10px;
}
.cat{
  font-size:36px;
  background:#fff;
  border:1px solid var(--line);
  border-radius:16px;
  padding:10px;
}
.bubble{
  background:#fff;
  border:1px solid var(--line);
  border-radius:16px;
  padding:10px;
  font-weight:900;
}

.mission{
  margin-top:10px;
  background:#ecfeff;
  border:1px solid #67e8f9;
  border-radius:14px;
  padding:10px;
  font-weight:900;
}

.grid{
  margin-top:16px;
  display:grid;
  grid-template-columns:repeat(2,1fr);
  gap:12px;
}
@media(max-width:700px){
  .grid{ grid-template-columns:1fr; }
}

.q{
  background:#fff;
  border:1px solid var(--line);
  border-radius:18px;
  padding:14px;
  box-shadow:0 6px 12px rgba(0,0,0,.06);
}

.line{
  display:flex;
  align-items:center;
  flex-wrap:wrap;
  gap:8px;
  font-size:20px;
  font-weight:900;
}

/* å…¥åŠ›æ¬„ã¨ã€‡ã‚’ã¾ã¨ã‚ã‚‹ç®± */
.answerBox{
  position:relative;
  display:inline-block;
}

/* å…¥åŠ›æ¬„ */
.answerBox input{
  width:64px;
  padding:6px;
  font-size:18px;
  text-align:center;
  border-radius:10px;
  border:2px solid var(--line);
  background:#fff;
  position:relative;
  z-index:1;
}

/* æ­£å††ã®èµ¤ã€‡ï¼ˆä¸Šã«è¡¨ç¤ºï¼‰ */
.circle{
  position:absolute;
  width:36px;
  height:36px;
  border:4px solid rgba(239,68,68,0.65);
  border-radius:50%;
  top:-28px;           /* å…¥åŠ›æ¬„ã®ä¸Š */
  left:50%;
  transform:translateX(-50%);
  pointer-events:none;
  display:none;
}

/* æ­£è§£ã—ãŸã‚‰è¡¨ç¤º */
.answerBox.ok .circle{
  display:block;
}

.status{
  margin-top:6px;
  font-weight:900;
}
.q.ok .status{ color:var(--good); }
.q.ng .status{ color:var(--bad); }

.score{
  margin-top:14px;
  font-weight:1000;
  font-size:18px;
}
</style>
</head>

<body>
<div class="wrap">

<div class="top">
  <h1>ã‚ã¾ã‚Šã®ã‚ã‚‹ ã‚ã‚Šç®—ï¼ˆ3å¹´ç”Ÿï¼‰</h1>

  <div class="controls">
    <button id="makeBtn">ã‚‚ã‚“ã ã„ã‚’ã¤ãã‚‹</button>
    <button class="secondary" id="checkBtn">ã“ãŸãˆã‚ã‚ã›</button>
  </div>

  <div class="mascot">
    <div class="cat" id="cat">ğŸ±</div>
    <div class="bubble" id="catMsg">ãã‚‡ã†ã‚‚ ãŒã‚“ã°ã‚ã†ï¼</div>
  </div>

  <div class="mission" id="mission"></div>
</div>

<div class="grid" id="qs"></div>

<div class="score" id="score">ç‚¹æ•°ï¼šâ€” / 100</div>

</div>

<script>
/* å…¨è§’â†’åŠè§’ */
function toHalfWidth(str){
  return str.replace(/[ï¼-ï¼™]/g, s =>
    String.fromCharCode(s.charCodeAt(0) - 0xFEE0)
  );
}
function rand(min,max){
  return Math.floor(Math.random()*(max-min+1))+min;
}

/* ä»Šæ—¥ã®ãƒŸãƒƒã‚·ãƒ§ãƒ³ */
const missions=[
  "10ã‚‚ã‚“ ã›ã„ã‹ã„ã—ã‚ˆã†ï¼",
  "ã‚ã‚‹æ•°ãŒ 2ã€œ5 ã® ã‚‚ã‚“ã ã„ã« ã¡ã‚‡ã†ã›ã‚“ï¼",
  "ã¾ã¡ãŒãˆãšã« 5ã‚‚ã‚“ ã¤ã¥ã‘ã¦ ã¨ã“ã†ï¼",
  "ã‚†ã£ãã‚Š ã¦ã„ã­ã„ã« ãœã‚“ã¶ ã‚„ã‚ã†ï¼"
];
document.getElementById("mission").textContent =
  "ğŸ¾ ãã‚‡ã†ã®ãƒŸãƒƒã‚·ãƒ§ãƒ³ï¼š " +
  missions[new Date().getDate() % missions.length];

/* å•é¡Œç”Ÿæˆ */
let problems=[];
const QNUM=10;

function makeProblems(){
  const out=[];
  const set=new Set();
  while(out.length<QNUM){
    const b=rand(2,9);
    const q=rand(2,9);
    const r=rand(1,b-1);
    const a=b*q+r;
    const key=`${a}/${b}`;
    if(set.has(key)) continue;
    set.add(key);
    out.push({a,b,q,r});
  }
  return out;
}

function render(){
  const qs=document.getElementById("qs");
  qs.innerHTML="";
  problems.forEach((p)=>{
    const d=document.createElement("div");
    d.className="q";
    d.innerHTML=`
      <div class="line">
        ${p.a} Ã· ${p.b} ï¼
        <span class="answerBox">
          <span class="circle"></span>
          <input class="ansQ">
        </span>
        <span>ã‚ã¾ã‚Š</span>
        <span class="answerBox">
          <span class="circle"></span>
          <input class="ansR">
        </span>
      </div>
      <div class="status">ã¾ã </div>
    `;
    qs.appendChild(d);
  });

  document.querySelectorAll("input").forEach(inp=>{
    inp.addEventListener("input",e=>{
      e.target.value = toHalfWidth(e.target.value);
    });
  });

  document.getElementById("catMsg").textContent="ã•ã‚ã€ã¯ã˜ã‚ã‚ˆã†ï¼";
  document.getElementById("score").textContent="ç‚¹æ•°ï¼šâ€” / 100";
}

/* ã“ãŸãˆã‚ã‚ã› */
function check(){
  const cards=document.querySelectorAll(".q");
  let score=0;

  cards.forEach((card,i)=>{
    const qBox=card.querySelector(".ansQ").parentElement;
    const rBox=card.querySelector(".ansR").parentElement;
    qBox.classList.remove("ok");
    rBox.classList.remove("ok");

    const uq=Number(card.querySelector(".ansQ").value);
    const ur=Number(card.querySelector(".ansR").value);

    const okQ = uq===problems[i].q;
    const okR = ur===problems[i].r;

    if(okQ) qBox.classList.add("ok");
    if(okR) rBox.classList.add("ok");

    const okAll = okQ && okR;
    card.classList.remove("ok","ng");
    card.classList.add(okAll?"ok":"ng");
    card.querySelector(".status").textContent =
      okAll?"ã›ã„ã‹ã„ï¼":"ã–ã‚“ã­ã‚“â€¦";

    if(okAll) score+=10;
  });

  document.getElementById("score").textContent =
    `ç‚¹æ•°ï¼š${score} / 100`;

  const cat=document.getElementById("cat");
  const msg=document.getElementById("catMsg");
  if(score===100){
    cat.textContent="ğŸ˜»";
    msg.textContent="ã‹ã‚“ãºãï¼ï¼ãœã‚“ã¶ ã›ã„ã‹ã„ï¼";
  }else if(score>=70){
    cat.textContent="ğŸ˜¸";
    msg.textContent="ã™ã”ã„ï¼ã‚ã¨ ã™ã“ã—ï¼";
  }else{
    cat.textContent="ğŸ±";
    msg.textContent="ã ã„ã˜ã‚‡ã†ã¶ï¼ã¤ã ã„ã“ã†ï¼";
  }
}

/* åˆæœŸåŒ– */
document.getElementById("makeBtn").onclick=()=>{
  problems=makeProblems();
  render();
};
document.getElementById("checkBtn").onclick=check;

problems=makeProblems();
render();
</script>
</body>
</html>
